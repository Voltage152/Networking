#### R19 假定 Bob 从 Alice 处接收到一个 PGP 报文。Bob 怎样才能确定 Alice (而不是 Trudy) 生成了该报文？PGP 为了保证报文完整性使用了 MAC 吗？
  
   * PGP 使用了数字签名，而不是 MAC
   
   * A 给 B 发 PGP 的加密流程如下:
   
      * A 使用 Ks 加密报文 m，得到 Ks(m)，A 使用 B 的公钥 Kb+ 加密该对称密钥 Ks，得到 `Kb+(Ks)`，组合两者形成一个包 P1，P1 包内容是 `[Ks(m) + Kb+(Ks)]`。
      
      * 上述步骤提供了机密性，接下来提供完整性和发送者鉴别性。使用摘要算法 SHA 或者 MD5 计算出 P1 的摘要信息 `MAC(P1)`，使用 A 的私钥加密该摘要信息得到 数字签名 `Ka-(MAC(P1))`，然后组合形成一个包 P2，P2 包的内容是 `(P1 + Ka-(MAC(P1)))`。
      
   * B 收到 A 发送的 PGP 的解密流程如下:
   
      * 用 Ka+ 解密 `Ka-(MAC(P1))` 得到 `MAC(P1)`，用摘要算法计算 `MAC(P1)'`，比较 `MAC(P1) == MAC(P1)'`，若相等，则报文完整性得到鉴别，并且能够证明此报文确实来自 A。
      
      * 用 Kb- 解密 `Kb+(Ks)` 得到 Ks，然后用 Ks 解密 Ks(m) 得到 m。
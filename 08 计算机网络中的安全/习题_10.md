#### P10 假定 Alice 要与采用对称密钥密码体制的 Bob 使用一个会话密钥 Ks 通信。在 8.2 节中，我们知道了如何使用公开密钥密码从 Alice 向 Bob 分发该会话密钥。在本习题中，我们探讨不使用公开密钥而使用一个密钥分发中心（KDC）分发会话密钥的方法。KDC 是一个与每个注册用户共享独特的秘密对称密钥的服务器。对于 Alice 和 Bob 而言，Ka-kdc 和 Kb-kdc 表示了这些密钥。设计一个使用 KDC 向 Alice 和 Bob 分发 Ks 的方案。你的方案应当使用三种报文来分发会话密钥：一种从 Alice 到 KDC 的报文；一种从 KDC 到 Alice 的报文。最后一种是从 Alice 到 Bob 的报文。第一种报文为 Ka-kdc(A, B)。使用标记 Ka-kdc、Kb-kdc、S、A 和 B 回答下列问题。
#### a. 第二种报文是什么？
#### b. 第三种报文是什么？

  ![](https://github.com/YangXiaoHei/Networking/blob/master/08%20计算机网络中的安全/image/p10.png)
  
  * a.
     * 第二种报文是 KDC 发给 A 的报文，用 A 月 KDC 之间的共享密钥 Ka-kdc 加密了 K 和 kb-kdc(A, K) 组合的包。
    
  * b.
     * 第三种报文是 kb-kdc(A, K)，用来告知 B 是 A 要与他通信，并且把对话密钥交给他。

#### P11 计算一个不同于图 8-8 中的两个报文的第三个报文，使该报文具有与图 8-8 中的报文相同的校验和。
  *  ![](https://github.com/YangXiaoHei/Networking/blob/master/08%20计算机网络中的安全/image/p11.png)
  
#### P12 假定 Alice 和 Bob 共享两个秘密密钥：一个鉴别密钥 S1 和一个对称加密密钥 S2。扩充图 8-9，使之提供完整性和机密性。

   * ![](https://github.com/YangXiaoHei/Networking/blob/master/08%20计算机网络中的安全/image/p12.png)

#### P13 在 BitTorrent P2P 文件分发协议中（参见第 2 章），种子将文件分割成块，并且对等方彼此重分发这些块。不使用任何保护，一个攻击者能够容易地通过假冒善意的对等方并向洪流中的一些对等方发送假冒块来实施破坏。这些未被怀疑的对等方则重新向其他对等方发送这些假冒块，其他对等方则将再次向甚至更多的对等方重新分发这些假冒块。因此，对于 BitTorrent 来说，采用一种机制使对等方能验证一个块的完整性，从而使得假冒块无法分发，这是至关重要的。假设当对等方加入一个洪流时，它初始从一个完全受信任的源得到一个 .torrent 文件。描述允许对等方验证块完整性的一个简单的方案。

   * 把所有块的 MD5 或者 SHA1 都算好存在 .torrent 文件中，每收到一个块就计算 MD5 或 SHA1 然后与 .torrent 文件中的进行比较，如果一致，就是合法的包，如果不一致，就遭到了篡改或者损坏。

#### P14 OSPF 路由选择协议使用一个 MAC 而不是数字签名来提供报文完整性。你认为选择 MAC 而未选择数字签名的原因是什么？

   * 数字签名需要一个公钥基础设施来提供公钥认证，并且非对称加密的计算耗费 CPU 的性能，对于在同一个 AS 内运行的所有路由器来说，管理员能很容易的在路由器中配置所有路由器共享的鉴别密钥，因此不需要使用数字签名。

#### P15 考虑图 8-18 中的鉴别协议，其中 Alice 向 Bob 鉴别她自己，我们看来工作正常（即我们没有发现其中有缺陷）。现在假定当 Alice 向 Bob 鉴别她自己的同时，Bob 必须向 Alice 鉴别他自己。给出一个情况，此时 Trudy 假装是 Alice，向 Bob 鉴别她自己是 Alice。（提示，该协议运行的顺序，鉴别过程可由 Trudy 或 Bob 发起，能够任意地交织在一起。特别注意 Bob 和 Alice 将使用不重数这样一个事实。如果不小心的话，能够恶意地使用相同的不重数）。
 
   * ![](https://github.com/YangXiaoHei/Networking/blob/master/08%20计算机网络中的安全/image/p15.png)

#### P16 一个自然的问题是我们能否使用一个不重数的公钥密码来解决 8.4 节中的端点鉴别问题。考虑下列自然的协议：1、Alice 向 Bob 发送报文 "I am Alice"；2、Bob 选择一个不重数并将其发送给 Alice；3、Alice 使用她的私钥来加密该不重数并向 Bob 发送得到的值；4、Bob 对接收到的报文应用 Alice 的公钥。因此，Bob 计算 R 并鉴别了 Alice。
#### a. 画图表示这个协议，使用本书中应用的公钥和私钥的标记法。 
#### b. 假定未使用证书。描述 Trudy 怎样能够通过拦截 Alice 的报文，进而对 Bob 假装她是 Alice 而成为一名 “中间人”。

   * a.
      *  ![](https://github.com/YangXiaoHei/Networking/blob/master/08%20计算机网络中的安全/image/p16.1.png)

   * b.
      * ![](https://github.com/YangXiaoHei/Networking/blob/master/08%20计算机网络中的安全/image/p16.2.png)

#### P17 图 8-19 显示了 Alice 必须执行的 PGP 的操作，以提供机密性、鉴别和完整性。图示出当 Bob 接收来自 Alice 的包时必须执行的对应操作。

   * PGP 的加密过程如下:
      * 1、Alice 用对称密钥 Ks 加密报文 m 得到 Ks(m)
      * 2、Alice 用 Bob 的公钥 Kb+ 加密 Ks 得到 Kb+(Ks)
      * 3、Alice 组合 Ks(m) 和 Kb+(Ks) 得到 P1
      * 4、Alice 计算 P1 的 MAC，然后使用私钥 Ka- 加密该 MAC，将 P1 和 Ka-(MAC) 组合成 P2
      
   * Bob 收到该包后解密过程如下:
      * 1、Bob 使用 Alice 的公钥 Ka+ 解密得到 MAC
      * 2、Bob 计算 P1 的 MAC，并与解密得到的进行比较，如果不同则丢弃，相同继续。
      * 3、Bob 使用自己的私钥 Kb- 解密得到 Ks
      * 4、Bob 使用 Ks 解密 Ks(m) 得到原始报文 m 





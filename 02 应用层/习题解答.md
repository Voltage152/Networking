#### P1 是非判断题。
#### a. 假设用户请求由某些文本和 3 幅图像组成的 Web 页面。对于这个页面，客户将发送一个请求报文并接收 4 个响应报文。
#### b. 两个不同的 Web 页面（例如，www.mit.edu/research.html 及 www.mit.edu/students.html ） 可以通过同一个持续连接发送。
#### c. 在浏览器和初始服务器之间使用非持续连接的话，一个 TCP 报文段是可能携带两个不同的 HTTP 服务请求报文的。
#### d. 在 HTTP 响应报文中的 Date: 首部指出了该响应中对象最后一次修改的时间。
#### e. HTTP 响应报文决不会具有空的报文体。

> a. ❌
> 
> 客户先发送一个请求报文，此时得到的响应报文中包含有文本内容以及 3 幅图像的 URL 信息，此时客户再针对每个图像的 URL 分别发送请求报文进行请求。
> 
> b. ✅
> 
> HTTP 协议基于 TCP 连接，因为客户与 `www.mit.edu` 建立了 TCP 连接，所以同一台服务器上的不同网页都可以在该 TCP 连接上传送。
> 
> c. ❌
> 
> 非持续连接，一个 TCP 报文段只能携带一个 HTTP 请求报文
> 
> d. ❌
> 
> HTTP 响应报文中的 Date: 字段值得是服务器检索到所请求的对象，生成响应报文并将其插入到响应报文中的时间点，而不是被请求对象的最后一次修改时间，最后一次的修改时间由首部行 Last-Modified: 首部行描述。
> 
> e. ❌
> 
> HTTP 响应报文可以具有空的报文体，比如在 HTTP 请求报文中指定方法名为 HEAD 即可。

#### P2 阅读有关 FTP 的 RFC 959。列出这个 RFC 所支持的所有客户命令。

> // TODO 
> 
> [RFC 959](https://tools.ietf.org/html/rfc959)

#### P3 考虑一个 HTTP 客户要获取一个给定 URL 的 Web 页面。该 HTTP 服务器的 IP 地址开始时并不知道。在这种情况下，除了 HTTP 外，还需要什么运输层和应用层协议？

> 还需要 DNS 应用层协议，用来将 URL 中的主机名映射到主机名对应的 IP 地址，而 DNS 基于 UDP 协议，HTTP 报文的传输基于 TCP 协议。

#### P4 考虑当浏览器发送一个 HTTP GET 报文时，通过 Wireshake 俘获到下列 ASCII 字符串（即这是一个 HTTP GET 报文的实际内容）。字符 <cr> <lf> 是回车和换行符（即下面文本中的斜体字符串 <cr> <lf> 表示单个回车符，该回车符包含在 HTTP 首部中的相应位置）。回答下列问题，指出你在下面 HTTP GET 报文中找到答案的地方。

~~~
GET /cs453/index.html HTTP/1.1<cr><lf>
Host: gai a.cs.umass.edu<cr><lf>
User-Agent: Mozilla/5.0 ( Windows;U; Windows NT 5.1; en-US; rv:1.7.2) Gec ko/20040804 Netscape/7.2 (ax) <cr><lf>
Accept:ex
t/xml, application/xml, application/xhtml+xml, text /html;q=0.9, text/plain;q=0.8,image/png,*/*;q=0.5 <cr><lf>
Accept-Language: en-us,en;q=0.5<cr><lf>
Accept- Encoding: zip,deflate<cr><lf>
Accept-Charset: ISO -8859-1,utf-8;q=0.7,*;q=0.7<cr><lf>
Keep-Alive: 300<cr> <lf>
Connection:keep-alive<cr><lf>
<cr><lf>
~~~


#### a. 由浏览器请求的文档的 URL 是什么？
#### b. 该浏览器运行的是 HTTP 的何种版本？
#### c. 该浏览器请求的是一条非持续连接还是一条持续连接？
#### d. 该浏览器所运行的主机的 IP 地址是什么？
#### e. 发起该报文的浏览器的类型是什么？在一个 HTTP 请求报文中，为什么需要浏览器类型？

> a.
> 
> 文档的 URL 是 `/cs453/index.html`
> 
> b.
> 
> 该浏览器运行的 HTTP 版本是 `1.1`
> 
> c.
> 
> 该浏览器请求的是一条持续连接
> 
> d.
> 
> IP 地址这个信息不包含于 HTTP 报文中，IP 地址将在网络层被附着在报文段上。
> 
> e.
> 
> 浏览器类型是 `Mozilla/5.0`，因为可能要根据不同的浏览器做相应的适配，比如服务器会返回不同的 html 文件。

#### P5 下面文本中显示的是来自服务器的回答，以响应上述问题中的 HTTP GET 报文。回答下列问题。指出你在下面报文中找到答案的地方。

~~~
HTTP/1.1 200 OK<cr><lf>
Date: Tue, 07 Mar 2008 12:39:45GMT<cr><lf>
Server: Apache/2.0.52 (Fedora) <cr><lf>
Last-Modified: Sat, 10 Dec2005 18:27:46 GMT<cr><lf>
ETag: “526c3-f22-a88a4c80”<cr><lf>Accept- Ranges: bytes<cr><lf>
Content-Length: 3874<cr><lf>
Keep-Alive: timeout=max=100<cr><lf>
Connection: Keep-Alive<cr><lf>Content-Type: text/html; charset= ISO-8859-1<cr><lf>
 <cr><lf>
 <!doctype html public “- //w3c//dtd html 4.0 transitional//en”><lf><html><lf> <head><lf> <meta http-equiv=”Content-Type” content=”text/html; charset=iso-8859-1”><lf> <meta name=”GENERATOR” content=”Mozilla/4.79 [en] (Windows NT 5.0; U) Netscape]”><lf> <title>CMPSCI 453 / 591 / NTU-ST550A Spring 2005 homepage</title><lf></head><lf> <much more document text following here (not shown)>
~~~

#### a. 服务器能否成功地找到那个文档？该文档提供回答是什么时间？
#### b. 该文档最后修改是什么时间？
#### c. 文档中被返回的字节有多少？
#### d. 文档被返回的前 5 个字节是什么？该服务器同意一条持续连接吗？

> a.
> 
> 服务器已经成功的找到了该文档，该文档提供回答的时间是 `Tue, 07 Mar 2008 12:39:45GMT`
> 
> b.
> 
> 该文档最后修改时间是 `Sat, 10 Dec2005 18:27:46 GMT`
> 
> c.
> 
> 文档中被返回的字节数是 `3874 字节`
> 
> d.
> 
> 前 5 个字节是 `<!doc`，该服务器同意持续连接。

#### P6 获取 HTTP/1.1 规范 （RFC 2616）。回答下列问题
#### a. 解释在客户和服务器之间用于指示关闭持续连接的信令机制。客户、服务器或两者都能发送信令通知连接关闭了吗？
#### b. HTTP 提供了什么加密服务？
#### c. 一个客户能够与一个给定的服务器打开 3 条或更多并发连接吗？
#### d. 如果一个服务器或一个客户检测到连接已经空闲一段时间，该服务器或客户可以关闭两者之间的传输连接。一侧开始关闭连接而另一侧通过该链路传输数据是可能的吗？请解释。

> //TODO
> 
> [RFC 2616](https://tools.ietf.org/html/rfc2616)
> 
> a.
> 
> 客户和服务器之间通过在首部行包含 Connection: 字段来指示是否关闭持续连接，当 Connection: 首部行填为 close，这代表在响应完本条请求报文后，或者在发送完本条响应报文后关闭 TCP 连接。如果 Connection: 首部行填为 keep-alive，这代表这是一条持续连接，若干个请求和响应报文将在同一 TCP 连接上传送。客户、服务器两者都能发送信令通知连接关闭。
> 
> b.
> 
> HTTP 不提供加密服务。
> 
> c.
> 
> (From RFC 2616) “Clients that use persistent connections should limit the number of simultaneous connections that they maintain to a given server. A single-user client SHOULD NOT maintain more than 2 connections with any server or proxy.”
> 
> 使用持续连接的客户端应该限制和指定服务器之间维护的 TCP 连接的个数，单个客户端不应该和任何服务器或者代理之间维护超过 2 条持续连接。
> 
> d.
> 
> 这是可能的，当服务器侦测到连接空闲并决定关闭连接，但此时客户端可能正好发送一
> 一个报文请求，因为在服务器端看来，这条连接空闲了好一会，因为它允许的空闲时长可能和客户端的允许时长不一致，而在客户端看来，这条连接还正在使用中。
> 

#### P7 假定你在浏览器中点击一条超链接获得 Web 页面。相关联的 URL 的 IP 地址没有缓存在本地主机上，因此必须使用 DNS 查询以获得该 IP 地址。如果主机从 DNS 得到 IP 地址之前已经访问了 n 个 DNS 服务器；相继产生的 RTT 依次为 RTT1、....、RTTn。进一步假定与链路相关的 Web 页面只包含一个对象，即由少量的 HTML 文本组成。令 RTT0 表示本地主机和包含对象的服务器之间的 RTT 值。假定该对象传输时间为零，则从客户点击该超链接到它接收到该对象需要多长时间？

> 如图
> 
> ![](https://github.com/YangXiaoHei/Networking/blob/master/02%20应用层/images/p7.png)
> 
> 2RTT0 + RTT1 + ... RTTn

#### P8 参照习题 P7，假定在同一服务器上某 HTML，文件引用了 8 个非常小的对象。忽略发送时间，在下列情况下需要多长时间。
#### a. 没有并行 TCP 连接的非持续 HTTP。
#### b. 配置有 5 个并行连接的非持续 HTTP。
#### c. 持续 HTTP。

> a.
> 
> 16RTT0 + RTT1 + ... RTTn
> 
> b.
> 
> 先获取 HTML 文件，这用了 2RTT0，然后再分两拨获取 8 个小对象，这耗时 2 x 2RTT0 = 4RTT0
> 
> 6RTT0 + RTT1 + ... + RTTn
> 
> c.
> 
> 先用 2RTT0 建立了 TCP 连接并接收了 HTML 文件，然后一个 RTT0 传输了 8 个非常小的文件
> 
> 3RTT0 + RTT1 + ... RTTn

#### P9 考虑图 2-12，其中有一个机构的网络和因特网相连。假定对象的平均长度为 850 000 比特，从这个机构网的浏览器到初始服务器的平均请求率是每秒 16 个请求。还假定从接入链路的因特网一侧的路由器转发一个 HTTP 请求开始，到接收到其响应的平均时间是 3 秒（参见 2.2.5 节）。将总的平均响应时间建模为平均接入时延（即从因特网路由器到机构路由器的时延）和平均因特网时延之和。对于平均接入时延，使用 a/(1 - ab)，式中 a 是跨越接入链路发送一个对象的平均时间，b 是对象对该接入链路的平均到达率。
#### a. 求出总的平均响应时间。
#### b. 现在假定在这个机构 LAN 中安装了一个缓存器。假定错失率为 0.4（命中率为 0.6），求出总的响应时间。

>
> ![](https://github.com/YangXiaoHei/Networking/blob/master/02%20应用层/images/p9.1.png)
>
> a.
> 
> `a = 85 x 10^4 bit / 15 x 10^6 bps = 0.0567 s`
> 
> `b = 16 个/s`
> 
> `平均接入时延 = a / (1 - ab) = 0.0567 / (1 - 0.0567 x 16) = 0.6 s`
> 
> `总的平均响应时间 = 平均接入时延 + 平均因特网时延 = 3.6 s`
> 
> b.
> 
> `b' = 0.4b = 0.4 x 16 = 0.64`
> 
> `平均接入时延 = a / (1 - ab') = 0.089 s`
> 
> `如果没命中缓存，总的响应时延 = 0.089 s + 3 s = 3.089 s`
> 
> 因为 0.6 的请求都命中缓存，因此上述的总的平均响应时延仅仅在 0.4 概率下发生，即 `总的平均响应时间 = 0.4 x 3.089 = 1.24 s`






